apiVersion: v1
kind: ConfigMap
metadata:
  name: fastmcp-config
  namespace: fastmcp-server
data:
  config.yaml: |
    server:
      host: "0.0.0.0"
      port: 8080

    backends:
      - name: "ollama-local"
        # Alteração aqui: Usamos o DNS interno do Kubernetes
        url: "http://ollama-service.ollama.svc.cluster.local:11434"
        
        # O health check verifica a raiz do serviço Ollama
        health_check:
          path: "/" 
          interval: "30s"

    routes:
      # Endpoints principais do Ollama
      - path: "/api/generate"
        backend: "ollama-local"
      - path: "/api/chat"
        backend: "ollama-local"
      - path: "/api/embeddings"
        backend: "ollama-local"

      # Endpoints de gestão de modelos
      - path: "/api/tags"
        backend: "ollama-local"
      - path: "/api/show"
        backend: "ollama-local"
      - path: "/api/copy"
        backend: "ollama-local"
      - path: "/api/delete"
        backend: "ollama-local"
      - path: "/api/pull"
        backend: "ollama-local"
      - path: "/api/push"
        backend: "ollama-local"
      - path: "/api/create"
        backend: "ollama-local"

      # Endpoints de status
      - path: "/api/ps"
        backend: "ollama-local"
      - path: "/api/version"
        backend: "ollama-local"
      
      # Rota "catch-all" para qualquer outra coisa em /api/
      - path: "/api/"
        backend: "ollama-local"
      
      # Rota raiz (para o health check)
      - path: "/"
        backend: "ollama-local"